[gcode_macro PRINT_BEGIN]
description: Start print macro
gcode:
    {% if printer.toolhead.homed_axes != 'xyz' %}
        G28
    {% endif %}
    BED_MESH_PROFILE LOAD=default
    
    G90
    M83

[gcode_macro PRINT_END]
description: finish print macro
gcode:
    G91
    G1 Z2 F3000
    G90

    DROP_TOOL
    FAN_OFF
    TURN_OFF_HEATERS
    BED_MESH_CLEAR

    M84

[gcode_macro FAN_OFF]
description: Turn off all fan
gcode:
    SET_FAN_SPEED SPEED=0 FAN=part_fan_0
    SET_FAN_SPEED SPEED=0 FAN=part_fan_1
    SET_FAN_SPEED SPEED=0 FAN=part_fan_2
    SET_FAN_SPEED SPEED=0 FAN=part_fan_3